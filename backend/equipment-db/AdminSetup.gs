/**
 * AdminSetup.gs
 * 
 * –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
 * 
 * –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
 * –∏–ª–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ Google Apps Script —Ä–µ–¥–∞–∫—Ç–æ—Ä
 */

/**
 * –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
 * 
 * –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ —Å–∏—Å—Ç–µ–º—É.
 * –í—ã–ø–æ–ª–Ω–∏—Ç–µ: –í—ã–ø–æ–ª–Ω–∏—Ç—å ‚Üí addFirstAdmin
 * 
 * @param {string} email - Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
 * @param {string} note - –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
 */
function addFirstAdmin(email, note) {
  if (!email) {
    Logger.log('‚ùå Email –Ω–µ —É–∫–∞–∑–∞–Ω');
    Logger.log('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: addFirstAdmin("user@example.com", "–ü–µ—Ä–≤—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä")');
    return;
  }
  
  Logger.log('üë§ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: ' + email);
  
  const result = addAdminManually(email, note || '–ü–µ—Ä–≤—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä');
  
  if (result.success) {
    Logger.log('‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
    Logger.log('   Email: ' + email);
    Logger.log('   –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');
  } else {
    Logger.log('‚ùå –û—à–∏–±–∫–∞: ' + result.message);
  }
  
  return result;
}

/**
 * –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
 * 
 * @param {string} email - Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 */
function checkAdminStatus(email) {
  if (!email) {
    Logger.log('‚ùå Email –Ω–µ —É–∫–∞–∑–∞–Ω');
    Logger.log('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: checkAdminStatus("user@example.com")');
    return;
  }
  
  Logger.log('üëë –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è: ' + email);
  
  const role = verifyAdminAccess(email);
  
  Logger.log('   –†–æ–ª—å: ' + role);
  Logger.log('   –Ø–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: ' + (role === 'admin' ? '–î–ê' : '–ù–ï–¢'));
  
  return role;
}

/**
 * –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
 */
function listAllAdmins() {
  Logger.log('üìã –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:');
  
  const admins = getAllAdmins();
  
  if (admins.length === 0) {
    Logger.log('   –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
    return;
  }
  
  admins.forEach((admin, index) => {
    Logger.log('   ' + (index + 1) + '. ' + admin.email);
    Logger.log('      - –î–æ–±–∞–≤–ª–µ–Ω: ' + admin.addedAt);
    Logger.log('      - –í—Ä—É—á–Ω—É—é: ' + admin.addedManually);
    Logger.log('      - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ' + admin.priority);
    if (admin.note) {
      Logger.log('      - –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: ' + admin.note);
    }
  });
  
  return admins;
}

